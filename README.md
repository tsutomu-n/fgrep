# fgrep - ファイル内のテキスト検索ツール

## 概要

`fgrep`は、指定されたディレクトリ内のファイルから特定のテキストパターンを検索するための便利な関数です。この関数は、`find`、`grep`、`ripgrep`、`fd`、`bat`などのコマンドラインツールを組み合わせて、高速かつ柔軟なファイル検索を可能にします。

## 目的

`fgrep`の主な目的は、大量のファイルの中から目的のテキストを素早く見つけ出すことです。プログラマーや開発者にとって、コードベース内の特定の関数、変数、またはパターンを検索する必要がある場面が頻繁にあります。`fgrep`を使用することで、そのようなテキスト検索を効率的に行うことができます。

## ユースケース

以下のようなシナリオで`fgrep`が役立ちます：

1. 大規模なプロジェクトにおいて、特定の関数やクラスを使用している箇所を見つけたい。
2. ログファイルから特定のエラーメッセージを検索したい。
3. 設定ファイルから特定のキーや値を検索したい。
4. ドキュメント内の特定のキーワードや記述を検索したい。

## 使用方法

```
fgrep [オプション] <ディレクトリ> <検索パターン> [ファイルパターン]
```

- `<ディレクトリ>`: 検索対象のディレクトリを指定します。
- `<検索パターン>`: 検索したいテキストパターンを指定します。デフォルトでは正規表現ではなく、リテラル文字列として扱われます。
- `[ファイルパターン]`: 検索対象のファイル名のパターンを指定します（例: `*.txt`、`*.log`など）。省略した場合、すべてのファイルが検索対象になります。

### オプション

- `-h`、`--help`: ヘルプメッセージを表示します。
- `-o`、`--output <file>`: 検索結果を指定されたファイルに保存します。
- `-f`、`--format <format>`: 出力ファイルの形式を指定します（`txt`、`md`、`jsonc`、`yaml`）。デフォルトは`txt`です。
- `-r`、`--regex`: 検索パターンを正規表現として扱います。
- `-t`、`--type <type>`: 指定されたファイルタイプのみを検索します（`text`、`binary`）。
- `-i`、`--ignore-case`: 大文字と小文字を区別しない検索を行います。
- `-s`、`--sort <option>`: 検索結果をソートします（`name`、`line`、`content`）。

## 使用例

```bash
# ~/projects 内の .sh ファイルから 'function' を検索
fgrep ~/projects 'function' '*.sh'

# ~/projects 内の .c ファイルから '^#include' を正規表現・大文字小文字区別なしで検索
fgrep -r -i ~/projects '^#include' '*.c'

# ~/documents 内のテキストファイルから 'TODO' を検索
fgrep -t text ~/documents 'TODO'

# ~/api 内のファイルから '200' を検索し、result.jsonc に JSONC 形式で保存
fgrep -f jsonc -o result.jsonc ~/api '200'
```

## 注意点

- `fgrep`は、`ripgrep`、`fd`、`bat`などの最新のコマンドラインツールを使用することで、高速かつ効率的な検索を実現しています。これらのツールがインストールされていない場合、`fgrep`は従来の`find`、`grep`、`cat`コマンドにフォールバックします。
- 検索結果は、デフォルトでは現在のディレクトリに`<検索パターン>_<ファイルパターン>_<タイムスタンプ>.<形式>`という名前で保存されます。`-o`オプションを使用して、出力ファイル名を指定することもできます。
- バイナリファイルを検索する場合は、`-t binary`オプションを使用してください。テキストファイルのみを検索する場合は、`-t text`オプションを使用します。
- 正規表現を使用する場合は、`-r`オプションを指定する必要があります。正規表現の構文は、`ripgrep`または`grep`のものに従います。
- ヘルプメッセージや使用例を参照して、`fgrep`の機能を十分に理解してから使用することをお勧めします。

## インストール方法

`fgrep`関数を使用するには、以下の手順に従ってください。

1. `~/.zshrc`ファイル（または使用しているシェルの設定ファイル）を開きます。
2. `fgrep`関数の定義を`~/.zshrc`ファイルの最後に追加します。
3. ファイルを保存し、`source ~/.zshrc`コマンドを実行して変更を反映させます。

また、`fgrep`関数は`ripgrep`、`fd`、`bat`などの最新のコマンドラインツールを使用することで、より高速かつ便利な検索が可能になります。これらのツールをインストールすることをお勧めします。インストール方法については、それぞれのツールの公式ドキュメントを参照してください。

- `ripgrep`: [https://github.com/BurntSushi/ripgrep](https://github.com/BurntSushi/ripgrep)
- `fd`: [https://github.com/sharkdp/fd](https://github.com/sharkdp/fd)
- `bat`: [https://github.com/sharkdp/bat](https://github.com/sharkdp/bat)

これらのツールがインストールされていない場合でも、`fgrep`関数は従来の`find`、`grep`、`cat`コマンドを使用して検索を行うため、基本的な機能は問題なく動作します。

## まとめ

`fgrep`関数は、ファイル内のテキスト検索を効率的に行うための強力なツールです。柔軟なオプションとわかりやすい使用方法により、初心者から上級者まで幅広いユーザーに適しています。是非、日々の開発やテキスト処理のタスクで`fgrep`を活用してみてください。
